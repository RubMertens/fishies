var z=Object.defineProperty;var N=(o,t,e)=>t in o?z(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var A=(o,t,e)=>(N(o,typeof t!="symbol"?t+"":t,e),e);import{G as m,V as w,M as T,S as U,a as v,b as Q,L as I,B as j,c as f,d as K,P as B,A as G,D as R,O as W,e as Y,C as F,W as _,f as V,g as Z}from"./vendor.fcd10b47.js";const P=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const M of n.addedNodes)M.tagName==="LINK"&&M.rel==="modulepreload"&&i(M)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}};P();const H=5,X=.1,J=1e-4,q=5,$=4;class S{constructor(t,e,i,s=!1){A(this,"mesh");A(this,"group");A(this,"direction");A(this,"velocity");A(this,"wanderAngle");A(this,"accelleration");A(this,"maxSpeed");A(this,"maxSteeringForce");A(this,"radius");A(this,"debugMesh");A(this,"debugLines",[]);A(this,"debugLinegroup",new m);this.scene=t,this.tracker=i,this.isDebug=s,this.mesh=e,this.group=new m,this.group.add(this.mesh);const n=150;this.group.position.set(l(-n,n),l(-n,n),l(-n,n)),this.direction=new w(l(-1,1),0,l(-1,1)),this.velocity=this.direction.clone(),this.radius=15,this.accelleration=1,t.add(this.group),this.wanderAngle=0,this.maxSpeed=10,this.maxSteeringForce=X,this.isDebug&&(this.debugMesh=new T(new U(this.radius,32,32),new v({color:"red",transparent:!0,opacity:.1})),t.add(this.debugMesh))}get position(){return this.group.position}checkBounds(){["x","z"].forEach(i=>{this.group.position[i]>300&&(this.group.position[i]=-300),this.group.position[i]<-300&&(this.group.position[i]=300)})}update(t){const e=this.tracker.getLocalEntities(this.position,this.radius);this.applySteering(t,e);const i=this.velocity.clone();i.multiplyScalar(t),this.group.position.add(i);const s=this.direction,n=new Q;n.lookAt(new w(0,0,0),s,new w(0,1,0)),this.group.quaternion.setFromRotationMatrix(n),this.isDebug&&this.updateDebug(e)}updateDebug(t){var d;const{x:e,y:i,z:s}=this.group.position;(d=this.debugMesh)==null||d.position.set(e,i,s),this.scene.remove(this.debugLinegroup),this.debugLinegroup=new m;const n=new I({color:"white"}),M=new I({color:"red"});for(const D of t){const u=new j;u.setFromPoints([this.position,D.position]),this.debugLinegroup.add(new f(u,n));const h=new j;h.setFromPoints([D.position,D.position.clone().add(D.velocity)]),this.debugLinegroup.add(new f(h,M))}const c=new j;c.setFromPoints([this.position,this.position.clone().add(this.velocity)]),this.debugLinegroup.add(new f(c,M)),this.scene.add(this.debugLinegroup)}applySteering(t,e){const i=new w(0,0,0),s={separation:this.applySeparation(e),alignment:this.applyAlignment(e),cohesion:this.applyCohesion(e),wander:this.applyWander()};i.add(s.wander),i.add(s.separation),i.add(s.alignment),i.add(s.cohesion),i.multiplyScalar(this.accelleration*t),i.multiply(new w(1,.1,1)),i.normalize(),i.multiplyScalar(this.maxSteeringForce),this.velocity.add(i),this.velocity.normalize(),this.velocity.multiplyScalar(this.maxSpeed),this.direction=this.velocity.clone(),this.direction.normalize()}applyWander(){this.wanderAngle+=.1*l(-2*Math.PI,2*Math.PI);const t=new w(Math.cos(this.wanderAngle),Math.cos(this.wanderAngle),Math.cos(this.wanderAngle)),e=this.direction.clone();return e.multiplyScalar(2),e.add(t),e.normalize(),e.multiplyScalar(H)}applySeparation(t){if(t.length===0)return new w(0,0,0);const e=new w(0,0,0);for(const i of t){const s=Math.max(i.position.distanceTo(this.position)-(this.radius+i.radius),.001),n=new w().subVectors(this.position,i.position).normalize(),M=J*((this.radius+i.radius)/s);e.add(n.multiplyScalar(M))}return e}applyAlignment(t){if(t.length===0)return new w(0,0,0);const e=new w(0,0,0);for(const i of t)e.add(i.direction);return e.normalize(),e.multiplyScalar(q),e}applyCohesion(t){if(t.length===0)return new w(0,0,0);const e=new w(0,0,0);for(const s of t)e.add(s.position);e.multiplyScalar(1/t.length);const i=e.clone().sub(this.position);return i.normalize(),i.multiplyScalar($),i}}const l=(o,t)=>Math.random()*(t-o)+o;class tt{constructor(){A(this,"entities",[])}getLocalEntities(t,e){return this.entities.filter(i=>{const s=t.distanceTo(i.position);return s!==0&&s<e})}}var et="/fishies/assets/uw_bk.86c49047.jpg",it="/fishies/assets/uw_dn.cc27459a.jpg",st="/fishies/assets/uw_ft.d8bcea4b.jpg",nt="/fishies/assets/uw_lf.d88760b2.jpg",ot="/fishies/assets/uw_rt.280677c2.jpg",At="/fishies/assets/uw_up.1461a0d1.jpg",wt="/fishies/assets/fish1.18407612.obj",Mt="data:model/mtl;base64,IyBCbGVuZGVyIE1UTCBGaWxlOiAnRmlzaDEuYmxlbmQnCiMgTWF0ZXJpYWwgQ291bnQ6IDMKCm5ld210bCBCb3R0b20KTnMgOTYuMDc4NDMxCkthIDEuMDAwMDAwIDEuMDAwMDAwIDEuMDAwMDAwCktkIDAuNTQ3NjgwIDAuNjQwMDExIDAuNTgyMjgxCktzIDAuNTAwMDAwIDAuNTAwMDAwIDAuNTAwMDAwCktlIDAuMDAwMDAwIDAuMDAwMDAwIDAuMDAwMDAwCk5pIDEuMDAwMDAwCmQgMS4wMDAwMDAKaWxsdW0gMgoKbmV3bXRsIEZpbnMKTnMgOTYuMDc4NDMxCkthIDEuMDAwMDAwIDEuMDAwMDAwIDEuMDAwMDAwCktkIDAuNjQwMDAyIDAuNTI0NzkwIDAuMzIxMzY1CktzIDAuNTAwMDAwIDAuNTAwMDAwIDAuNTAwMDAwCktlIDAuMDAwMDAwIDAuMDAwMDAwIDAuMDAwMDAwCk5pIDEuMDAwMDAwCmQgMS4wMDAwMDAKaWxsdW0gMgoKbmV3bXRsIFRvcApOcyA5Ni4wNzg0MzEKS2EgMS4wMDAwMDAgMS4wMDAwMDAgMS4wMDAwMDAKS2QgMC42NDAwMTQgMC4yODY5MzEgMC4xOTI1NzcKS3MgMC41MDAwMDAgMC41MDAwMDAgMC41MDAwMDAKS2UgMC4wMDAwMDAgMC4wMDAwMDAgMC4wMDAwMDAKTmkgMS4wMDAwMDAKZCAxLjAwMDAwMAppbGx1bSAyCg==",at="/fishies/assets/fish2.9644ec60.obj",rt="data:model/mtl;base64,IyBCbGVuZGVyIE1UTCBGaWxlOiAnRmlzaDIuYmxlbmQnCiMgTWF0ZXJpYWwgQ291bnQ6IDMKCm5ld210bCBCb2R5Ck5zIDk2LjA3ODQzMQpLYSAxLjAwMDAwMCAxLjAwMDAwMCAxLjAwMDAwMApLZCAwLjA1OTQzMSAwLjA5MDkwNSAwLjY0MDAwNApLcyAwLjUwMDAwMCAwLjUwMDAwMCAwLjUwMDAwMApLZSAwLjAwMDAwMCAwLjAwMDAwMCAwLjAwMDAwMApOaSAxLjAwMDAwMApkIDEuMDAwMDAwCmlsbHVtIDIKCm5ld210bCBGaW5zCk5zIDk2LjA3ODQzMQpLYSAxLjAwMDAwMCAxLjAwMDAwMCAxLjAwMDAwMApLZCAwLjU3ODQ0MCAwLjU0NTI2NiAwLjMwNTgyNwpLcyAwLjUwMDAwMCAwLjUwMDAwMCAwLjUwMDAwMApLZSAwLjAwMDAwMCAwLjAwMDAwMCAwLjAwMDAwMApOaSAxLjAwMDAwMApkIDEuMDAwMDAwCmlsbHVtIDIKCm5ld210bCBGcm9udApOcyA5Ni4wNzg0MzEKS2EgMS4wMDAwMDAgMS4wMDAwMDAgMS4wMDAwMDAKS2QgMC4xODU4NDIgMC4zOTM2MDEgMC44MDAwMDAKS3MgMC41MDAwMDAgMC41MDAwMDAgMC41MDAwMDAKS2UgMC4wMDAwMDAgMC4wMDAwMDAgMC4wMDAwMDAKTmkgMS4wMDAwMDAKZCAxLjAwMDAwMAppbGx1bSAyCg==",Dt="/fishies/assets/fish3.834b14ca.obj",lt="data:model/mtl;base64,IyBCbGVuZGVyIE1UTCBGaWxlOiAnRmlzaDMuYmxlbmQnCiMgTWF0ZXJpYWwgQ291bnQ6IDMKCm5ld210bCBCb2R5Ck5zIDk2LjA3ODQzMQpLYSAxLjAwMDAwMCAxLjAwMDAwMCAxLjAwMDAwMApLZCAwLjY0MDAwMCAwLjEwODk3NCAwLjAxNDg1MwpLcyAwLjUwMDAwMCAwLjUwMDAwMCAwLjUwMDAwMApLZSAwLjAwMDAwMCAwLjAwMDAwMCAwLjAwMDAwMApOaSAxLjAwMDAwMApkIDEuMDAwMDAwCmlsbHVtIDIKCm5ld210bCBPdXRsaW5lCk5zIDk2LjA3ODQzMQpLYSAxLjAwMDAwMCAxLjAwMDAwMCAxLjAwMDAwMApLZCAwLjAzNzU2OSAwLjAzNzU2OSAwLjAzNzU2OQpLcyAwLjUwMDAwMCAwLjUwMDAwMCAwLjUwMDAwMApLZSAwLjAwMDAwMCAwLjAwMDAwMCAwLjAwMDAwMApOaSAxLjAwMDAwMApkIDEuMDAwMDAwCmlsbHVtIDIKCm5ld210bCBTdHJpcGVzCk5zIDk2LjA3ODQzMQpLYSAxLjAwMDAwMCAxLjAwMDAwMCAxLjAwMDAwMApLZCAwLjY0MDAwMCAwLjYwNjM5NyAwLjUxMTg2MwpLcyAwLjUwMDAwMCAwLjUwMDAwMCAwLjUwMDAwMApLZSAwLjAwMDAwMCAwLjAwMDAwMCAwLjAwMDAwMApOaSAxLjAwMDAwMApkIDEuMDAwMDAwCmlsbHVtIDIK";async function ct(){let o=new K,t=new B(75,window.innerWidth/window.innerHeight,.01,1e3);t.position.set(100,-50,100),t.lookAt(0,0,0);const e=new G("white",.5),i=new R("white",1);i.position.set(0,10,0),o.add(i),o.add(e);const s={width:window.innerWidth,height:window.innerHeight},n=new W,M=new Y,c=await M.loadAsync(Mt);c.preload(),n.setMaterials(c);const d=await n.loadAsync(wt);d.rotateY(Math.PI);const D=await M.loadAsync(rt);D.preload(),n.setMaterials(D);const u=await n.loadAsync(at);u.rotateY(Math.PI);const h=await M.loadAsync(lt);h.preload(),n.setMaterials(h);const b=await n.loadAsync(Dt);b.rotateY(Math.PI);const x=new F().load([st,et,At,it,ot,nt]);o.background=x;let p=new _;p.setSize(s.width,s.height),document.body.appendChild(p.domElement);const g=new Array,L=new tt;function O(){const a=[d,u,b];return a[Math.floor(Math.random()*a.length)].clone()}for(let a=0;a<1e3;a++){let r;const C=O();console.log(C),a===0?r=new S(o,C,L,!0):r=new S(o,C,L),g.push(r),L.entities.push(r)}const E=new V(t,p.domElement),k=new Z;function y(){const a=k.getDelta();requestAnimationFrame(y),p.render(o,t),g.forEach(r=>r.update(a)),g.forEach(r=>r.checkBounds()),E.update()}y()}ct();
